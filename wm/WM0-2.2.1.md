---
title: WM0-2.2.1_水质模型的类型
tags: 1000天持续行动,水质模型教程
date:   2019-6-13
---
·[512]|1000天行动计划
**读书笔记**/热点追踪/论文研读/教程手册

# WM0-2.2 微观：细节内涵

在2.1节我们从宏观角度切入，从水质模型的底层基础数学模型，一直到水质模型进行了讨论，这几篇之后应该会对水质模型有了一定的认识。那么，宏观后接下来我们开始落地，讨论下水质模型的类型及水质模型的应用指南等相关内容，旨在对水质模型应用过程有所了解，当然虽然是微观，但是仍然不会聚焦具体模型上，还是稍微泛一些。

![基础内容2.2](http://comieswater-1254012817.cossh.myqcloud.com/2019/WM0-2_内容.png)

在项目中，我们决定使用模型时，我们必然会遇到一个问题，用什么模型呢？一般的选择方式，应该是找出多种模型，将模型的特征列出，进行对比分析，进而选择合适的模型。还有一些问题是需要着重强调的，那就是是不是要选择最复杂，功能最多的模型？是不是要选择最新开发出来的模型？

先做个回答，我们选择模型就如同选择车，选择最适合的车，而不是最高级，最贵的车，记住**适合**才是最好的。

那么如同车一样，有各种指标来衡量及分类，那么模型有哪些特征呢？

# 水质模型的类型

[TOC!?direction=lr]

![本节导图](http://comieswater-1254012817.cossh.myqcloud.com/2019/1561729910217.png)
实际上对于水质模型的类型，不管是在论文的综述中，还是模型的书籍中都要相对详细的分类，大家可以直接搜索“水质模型”的相关论文即可，那么本文主要从应用角度以本人实践经验进行简单的补充说明。

## 机理模型和统计模型

水质模型从模型的底层逻辑或者说计算方法角度来看，水质模型大体可分为：统计学模型和机理模型，这两种模型各有特点具体可看之前有关[数学模型](https://mp.weixin.qq.com/s?__biz=MjM5Mzg1MzEyOA==&mid=2247484968&idx=1&sn=5fcc6e4ad90e989ad45ccfd27e7b53b8&chksm=a691fd8f91e67499c304a653aab5f026b4175c13c80ea18b41a0c928476ca5012365219c50fc&token=1993909111&lang=zh_CN#rd)的历史，其中谈到的机械思维和数据思维，就是统计模型和机理模型的底层基础。

水质模型是从机理模型开始的，其通过描述水体中污染物的物理、化学、生物变化来模拟水体中的水质动态变化；而统计模型则以随机数学和统计学为基础，对所获取的数据进行分析获取有用信息的过程。其的不同点具体如下：

1. 对数据的需求不同。
	理论上来讲，机理模型需要很多边界条件等数据（气象、水文、水质），且因为有着大量模型参数和环境参数需要确定，确定这些参数需要花费很多资源，其可以说是对数据的要求较高。

	而统计模型则由于具有较少的参数，主要依赖于选择的算法，依据获取到的数据进行训练后进行使用。

	但是实际情况下，对于不同的水体，由于机理模型的本身内在的普适性，使得一旦经过考验过的机理模型（通俗的说就是成功的应用在了不同类型的水体），其很多的参数的范围是可以确定的，那么仅需要在参数范围修改就能够很快的应用在其他水体，这样数据的需求就少了很多。

	反看统计模型，由于黑箱的特点，其反而因为数据的代表性，不确定性等原因，使得其**必须**有足够的数据才有把握进行应用，而机理模型却对于有限的数据也能够进行一定的应用。

 	 总而言之，某种意义上说机理模型的数据少了也可以少的用法，多了也可以多的用法，但是统计模型必须数据足够多。（具体这个少量数据的用法是因为其的机理过程，如质量守恒过程，那么就能够根据质量守恒进行一些推断，而统计模型在数量少的时候基本不敢去随意推断。）从这个角度来说，对于国内的数据缺乏的现状，反而机理模型可能应用更加广泛。

2. 通用性不同。
	上面也提到了，对于机理模型其内在的机理特性，使得其具有较强的适应性，模型的通用性较好，能够修改少量的参数就能够很快的应用不同的水体。但是统计模型其一般是针对特定系统的，也就是说在某个水体训练好的模型，成功应用的模型，一般是无法很快的应用到其他的水体的，必须需要的大量数据进行重新的训练。并且机理由于白箱特点，模型的机理透明清楚，能够对某些地方的特点进行针对性的改进提高，统计模型都不晓得是怎么得到的，所以就无法进行完善修改，只能根据有积累更多的数据才能升级模型了。

3.  复杂度。
	两者的复杂度不同，先是应用复杂度，机理模型由于内在的过程是物理、化学、生物的过程就相对复杂一些，学习的入门门槛较高，一般需要专业的环境基础知识，很多初学者基本在这里就极其痛苦，更不用说很多开源的模型软件都是代码版本，连界面都没有，更是让人痛不欲生。搭建模型等校准过程做好和应用过程更是需要丰富的经验，且这个过程需要很多时间去磨。
	而统计模型，由于其建立在统计基础上，所以需要的更多的是数学基础，专业门槛较低，更多的是理解算法，然后进行不同算法的尝试，有一定的专业度，但是相对于机理模型来说，那是小巫见大巫，所以广受非环境专业领域欢迎。其工作量呢，主要是计算机在使劲，配置好算法之后，就看计算机的算力了，机理模型虽然也有计算量，但是其对于统计模型来说还是算少的。
	然后是建模复杂度，这个层面的复杂度就难以比较了，一般机理模型建模过程更加麻烦，需要很多不同各类型的数据，这些数据的格式还不同，需要按对应的格式进行输入模型，后进行调参。而统计模型相对建模过程简单点，一般需要相对单一的格式的数据，构建好算法即可。
	但是也要提出**特殊**的情况，我的一位老师给我讲了一个案例让我大开眼界，由于机理模型是有物理过程的，其有很强的类比特性。
	>当时某地河流发生了突发污染事故，想请我老师算一下这个污染物迁移状况，时间紧急，如果去获取足够的数据再去计算就没有意义了，那么我老师利用其的经验，询问获取到了河流的大概深度、长度、宽，和流量情况及泄漏量的大概情况后，直接用手头正在做的另外八竿子打不着的另外一条河流去模拟，结果据说还不错。

4. 响应关系。
	我们知道水质模型最重要的一点应用之一，就是获取**响应**关系。在模型构建好之后，通过改变输入条件，获取系统的对其的响应。通常来说，由于机理模型的基础建立在物理等规律之上，所以其对于长期的响应关系更加准确，比如月尺度、年尺度等，那么其用于负荷削减、水环境容量计算、工程评估就比较有优势。
	而统计模型由于其是一种采用回归、神经网络等统计模型，那么短期响应的应用能够获取更好的效果，如短期水质的预警等。当然，并非说机理不能做短期响应，注意上面说的是优势，机理模型做短期预警也没有任何问题。


两种模型并非非要对立起来，因为都是工具，没必要比出高低，两者完全可以配合使用。比如，现在很多有利用机理模型来生产大量的次生数据，来训练统计模型，观察统计模型的缺陷和特点，对其进行优化升级。同时，在现有数据较少的情况下，用机理模型可能更好，但随着国内对监测数据重视，未来必然统计模型会更多的应用。

## 模型的研究的范围
准确的说，模型的研究范围实际上并不能作为其特征，只能作为其应用条件。水质模型广义上就是指研究水体的模型。但是对于非专业领域来说，这个容易被混淆，所以这样分类也无可厚非。

这种分类就是看你研究关注的对象是什么？如果是纯粹的水体，比如河流、湖泊等，那么就是水体模型；如果研究的对象虽然是也是水体但是包含陆地在内的（考虑陆地上的污染物迁移过程），那么就是流域模型，也称为集水区模型。
具体而言：

- 集水区模型-流域模型
	研究模拟陆地上，降雨后产流的水体流动和其携带污染物最终汇入河流或者湖泊，其中比较重要的概念就是水力响应单元(HRU），其通过不同用地类型，渗透率，坡度等指标来追踪降水及其污染物形成汇流的全过程，其关注的重点实际上是水体在陆地上的过程，虽然也能模拟水体中污染物的一些物理化学过程，但是其是极其简单的关系。流域模型内部的机理过程相对简单，其复杂性主要体现在建模时所需要的各种陆地上的数据，一般需要GIS来辅助进行，并且现场的是建模过程十分重要的程序，流域模型可用于分析面源污染、海绵城市等。常见的流域模型有：LSPC\SWMM\HSPF.

- 受纳水体模型-水体模型
	受纳水体主要是针对地表水水体，其重点研究水体中的污染物的变化过程，也就是说其追踪的是水体内部的水流动过程，污染物从进入水体后的迁移、扩散、反应等过程，如果模拟了藻类，那么其还会去模拟植物对营养盐的吸收及释放。那么，相对于流域模型对陆地的分析，其更集中在水体中的过程，复杂性体现在水体内部的各种非线性过程，虽然调研也十分重要，但是弄明白水体中的过程更加重要。水体模型主要应用于水体污染治理，断面达标，水环境容量等。常见的水体模型有:EFDC\WASP\QUALK2K

	上述两个模型一般是不可换用的，但是其在某种粗略的分析中，在某种条件下两个模型都是可以用的，比如粗略分析简单的河网模型，那么既可以用流域模型分析河道，也可以用水体模型，当然更好的做法是用河网模型。

- 河网模型
	可以说，河网模型是介于流域模型和水体模型之间的，其主要是模拟平原地区的复杂的树形或环形的水体，这种对于水体模型也能胜任，但是有点高射炮打蚊子的感觉，并且对于有些复杂的河网，确实水体模型的网格不太好表示。

三种模型各有所用，虽然不能完全换用，但是其和搭配协调使用，一般全流域的过程，可以上游采用流域模型输出结果后为河网模型的边界条件，河网模型继而为水体模型提供边界，最后串联成为全流域的水体及污染物的跟踪。

## 空间维度
对于受纳水体模型而言，空间维度也是非常重要的，空间维度是说的是空间上的异质性，维度的理解我们从零维开始，所谓零维就是在所有空间方向上是均匀的，没有空间异质性考虑，比如我们常见的CSTR反应器（连续搅拌反应器）一般就是零维的，对于水体的零维模型而言，一般是湖泊用的比较多，将湖泊看作是一个整体，仅仅分析其入流和出流及其内部反应。

![CSTR概念模型](http://comieswater-1254012817.cossh.myqcloud.com/2019/1561676378436.png)
完全混合模型的概念图[^1x]

- 一维。其仅仅在一个方向是有空间变化，其他方向是均匀的。最简单的例子就是推流反应器了，这个表达的是水平一维的。而垂向一维则一般用于求解较深的水库或者湖泊深度方向上的变化。
- 二维。在两个方向上有变化，第三个方向是均匀的，细分为纵向二维和横向二维。横向二维就是那么传统的就是较宽的河流或者较浅的湖泊，需要在水平两个方向体现污染物浓度变化，也就是直角坐标系中的xy方向；而垂向二维就是xz或yz方向，主要是体现水深方向的污染物的变化。
- 三维，就是所谓xyz方向均考虑变化了。对于模型的能力而言，能够模拟三维，那么就可以进行降维模拟，反过来就不行了，但是一维的模型肯定无法模拟三维啦，不过实际上三维模型就是一维模型的方程扩展而已。既然这样，我们是不是只要三维模型就可以了呢？理论上是这样的，三维降维后和直接采用低维模型有什么区别？暂时先放一下，我们后续再谈。三维模型应用于湖泊的复杂过程研究、入海口附近的河流模拟等。

![维数表达图](http://comieswater-1254012817.cossh.myqcloud.com/2019/1561677311239.png)
维数示意图[^2x]

那么我们如何选择模拟的维度呢？原则就是要拿出我们的**奥卡姆剃刀思维**，根据**需求**和**资源**尽量采用**低维度**，也就是模型要尽可能简单。我知道你想问什么，复杂的模型不是表达的过程更多，更能体现水体中的变化过程，从而更加的准确吗？为什么要低维度优先呢？理论上讲，我看电影当然要3D的，那个过瘾呐，代价是票价更贵呢，因为3D拍摄过程需要多台摄像机，后期还要各种处理等等复杂过程。模型也是同理，复杂的模型需要的数据更多，考虑的参数更多，使得三维能够更加准确表达水体中的过程，但是代价就是其建模过程的复杂，并且随着数据及参数增多有更多的不确定性。

资源，就是所谓的数据资料，如果获取到的数据资料只有两个方向上的，比如对于湖泊你仅仅只有湖体不同位置表层的数据，那么你是不大好去模拟三维的情况的，因为你的数据只能在深度方向上取平均，那么垂向就无法判断是否合理。

回过头来说**需求**，根据需求选择，这是贯穿本节的主题。业主需求比较简单时候，比如只关心全湖平均值的达标，那么我们可能就可以简单的零维模型了（注：不过平时为了应对业主百变的需求，还是会稍微复杂那么一些，会用1维或者2维，求解全湖平均，防止返工。- -!)。当然，我们跟业主沟通过程中，要根据业主提出的需求，结合专业的知识进行判断，比如业主需要模拟藻类，那么结合专业知识，如果要能准确模拟藻类的生物量，那么其中条件之一就是需要模拟藻类的上沉和下浮，这必然要在考虑垂向变化，也就是至少二维了，一般对于宽阔的湖泊最好采用三维。


## 时间维度
有空间的角度，那么自然而然就有时间的角度，时间的角度就是模拟的变量是否随时间变化，如果近似恒定，那就是稳态模型，反之则是动态模型。上面的近似要体会一下，因为现实世界中是没有稳态存在的，这只能说其可以进行概化为恒定态，或者恒定态足够我们需求。比如长期开工的工厂，作为点源污染，其如果工艺稳定，那么其污染物排放就可以是恒定，可以采用稳态处理。但如果有面源污染，因为其依赖降雨量，那么我们就不能将其作为恒定处理了。


# 模型的选择主要步骤
根据上面的分类，我们对不同的模型特征有了一些认识，那么我们来小结一下如何选择模型。参考《水质模型入门课》中的要点，我补充了下，思路如下：

![模型选择范围](http://comieswater-1254012817.cossh.myqcloud.com/2019/1561729569891.png)

我们通过项目的需求得出模型选择的下限（也就是模型应能满足最低要求，不满足能力的模型都排除），根据资源设置其上限（资源包括资金、数据、人及经验能力等），上下限基本就将模型限制在几种范围内，最后任性选吧。这个是理想的情况，实际上平时不管是公司还是科研单位都有自己的积累和沉淀，都在一开始会选择一个模型钻研，后续就是拿着锤子都是钉子，只用这一个模型解决所有的问题，话说回来擅长哪个用哪个未尝不可，关键是确实能够满足需求即可，即使不满足，根据多年的积累也能二次开发进行完善。

上面的下限具体包括以下几种情况[^2x]：
1. 项目需要解决的问题，一切从问题出发，这点是最难的，业主有时候也并非专业人士，其提出的需求往往上管理需求，而我们作为专业人士，必然要转换为工程需求，比如上述说的藻类的问题，这都是需要反复沟通迭代的结果，并且考虑全面点要适当的放宽，因为需求是在不断的变化的，如果中期突然发现新的需求这个模型无法满足，那么更换基本是一个痛苦的过程。
2. 水体的特征，每一个水体都是一个哈姆雷特，尽管模型具有普适性，但是不同的水体的特征是不同的，每个一个水体都有她的灵魂在，所以更好的方法如果在时间条件允许可以多模型工具同时建模，探索水体的特征和模型的适用性。
3. 分析特定需求，特定的问题需要特定的解决方法。有的时候这些特殊需求也是需要考虑在内的，往往对模型选择的下限影响很大。


由于教程系列文章需要花费很多时间，难免出错，而这里不能进行后续完善，所以推荐大家关注我的博客，获取最新的修正和补充。
公众号的**社群**同步开启，感兴趣可在公众号对话框回复“社群”，获取群号和加入方式。

---

参考文献：
[^1x]: Steven C. Chapra.Surface Water-Quality Modeling[M].Waveland Press, 2008
[^2x]: 李博.水质模型入门课程.环in学院,2019


![页尾](http://comieswater-1254012817.cossh.myqcloud.com/页尾识别new-2017-09-22.png)
微信公众号 | 水环境编Cheng长
网          站 | comieswater.com


![赞赏我](http://comieswater-1254012817.cossh.myqcloud.com/IMG_3077.JPG)

 2019-6-13

 folder=/微信公众号/水环境编Cheng长/

 [1]: http://comieswater-1254012817.cossh.myqcloud.com/comieswater/1517576665753.jpg